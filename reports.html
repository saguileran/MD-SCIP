---
permalink: /reports/
layout: splash
author_profile: false
---


<h1 id="-weekly-reports-"><strong>Weekly Reports</strong></h1>
<h2 id="week-1">Week 1</h2>
<p>Prepare input files to MD and MC simulations:</p>
<ul>
<li>Import the molecules in chimera and create the PDB files</li>
<li>Adding missing parts of MR ligand.</li>
<li>Adding hydrogens and charges, it is done with an online page <a href="https://server.poissonboltzmann.org/">poissonboltzmann</a> and the output file is a PQR file</li>
<li>Define Cortisol (Col) and Aldosterone (AS4) PDB and mol files</li>
<li>Quantum calculations with amber (antichamber ), page 312 <a href="http://ambermd.org/doc12/Amber22.pdf">Amber22</a>. This method uses quantum calculations but other approaches are possible, such as in amking-it-rain</li>
<li>Relabelling COL and AS4</li>
<li>&#39;Install&#39; LiBELa and its requirements</li>
</ul>
<p>Reference [2] used to create and label Aldosteroe and Cortisol.</p>
<p>Some useful commands to run LiBELa:</p>
<p>Being at LiBELa_path/trunk/bin</p>
<pre><code>iMcLiBELa.app<span class="hljs-regexp">/Contents/</span>MacOS<span class="hljs-regexp">/iMcLiBELa</span>
</code></pre><p>To compute quantum calculations</p>
<pre><code>source /usr/local/amber20/amber<span class="hljs-selector-class">.sh</span>
antechamber -<span class="hljs-selector-tag">i</span> as4<span class="hljs-selector-class">.gesp</span> -fi gesp -o as4_resp<span class="hljs-selector-class">.mol2</span> -fo mol2 -c resp -eq <span class="hljs-number">2</span>
<span class="hljs-selector-id">#antechamber</span> -<span class="hljs-selector-tag">i</span> TPP<span class="hljs-selector-class">.mol2</span> -fi mol2 -o tpp<span class="hljs-selector-class">.com</span> -fo gcrt -gv <span class="hljs-number">1</span> -ge TPP<span class="hljs-selector-class">.gesp</span> -gn <span class="hljs-number">16</span>
</code></pre><p>Where:</p>
<ul>
<li><strong>gesp</strong>: gaussian ESP, file format</li>
<li><strong>RESP</strong>: charge method</li>
<li><strong>-eq</strong>: equalize atomic charge, using 2 by atomic paths and geometry</li>
<li><strong>GAFF</strong>: General Amber Force Field</li>
</ul>
<p>Another mid-step is to select the CPUs for quantum calculations, it is done in the server terminal.</p>
<p>Useful commands in chimera:</p>
<pre><code>disp (display atoms)
distance sel
sel :AS4/MOl (<span class="hljs-keyword">select</span> AS4/<span class="hljs-keyword">COl</span> atoms)
color green #<span class="hljs-number">1</span>/:MOL (<span class="hljs-keyword">change</span> color)
label @C= (label all Carbon atoms)
~label (remove all labels)
color C/#<span class="hljs-number">1</span>
transp <span class="hljs-number">75</span>,r (made ribon transparent)
<span class="hljs-keyword">match</span> #<span class="hljs-number">1</span> #<span class="hljs-number">2</span> (<span class="hljs-keyword">move</span> one <span class="hljs-keyword">to</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">is</span> two)
sel :MOL za &lt;<span class="hljs-number">5</span> (<span class="hljs-keyword">select</span> atoms <span class="hljs-keyword">close</span> <span class="hljs-keyword">to</span> MOl <span class="hljs-keyword">at</span> <span class="hljs-number">5</span> Amstrong <span class="hljs-keyword">of</span> distance)
</code></pre><p>All commands and documentation, <a href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/framecommand.html">Chimera User Guide - commands</a></p>
<h2 id="week-2">Week 2</h2>
<p>Merge protein and ligand PDBs and added solvent (water)</p>
<ul>
<li>Align protein and receptor using amber</li>
<li>Define Amber force field parameters</li>
<li>Join and check MR and aldosterone (AS4) PDBs files with tleap. The output file is a complex PDB file.</li>
<li>Create the input files for MD using complex.pdb file: .prmtop, .inpcrd</li>
<li>Convert prmtop file to PDB</li>
<li>Equilibrium system with amber <a href="http://ambermd.org/tutorials/advanced/tutorial3/section1.php">Build the starting structure and run a simulation to obtain an equilibrated system.</a> by adding Na and Cl to the solvent</li>
</ul>
<pre><code><span class="hljs-keyword">source</span> /usr/local/amber20/amber.<span class="hljs-keyword">sh</span> # <span class="hljs-keyword">execute</span> amber
tleap 
ambpdb -<span class="hljs-keyword">p</span> <span class="hljs-keyword">file</span>.prmtop &lt; <span class="hljs-keyword">file</span>.inpcrd &gt; file_leap.pdb # conver tleap outputs <span class="hljs-keyword">to</span> pdb
</code></pre><ul>
<li>Submit jobs to the server, commands lines <code>qsub</code> and <code>qstat</code></li>
<li>To watch the current status of simulations on sever visit <a href="http://nascimento.ifsc.usp.br/ganglia">Ganglia</a></li>
<li>Closter command lines <a href="http://nascimento.ifsc.usp.br/wordpress/?page_id=53">Nascimento Lab - Cluster</a></li>
</ul>
<pre><code><span class="hljs-keyword">qsub </span>amber.cpu.<span class="hljs-keyword">sub </span># run heat, density <span class="hljs-keyword">and, </span>min process on CPU
<span class="hljs-keyword">qsub </span>amber.<span class="hljs-keyword">sub </span>    # run equil <span class="hljs-keyword">and </span>prod process on GPU) 
<span class="hljs-symbol">qstat</span>              # show current jobs <span class="hljs-keyword">submitted
</span><span class="hljs-symbol">qdel</span> <span class="hljs-symbol">#job</span>       # kill process
</code></pre><p>Note: the heat, equil, and density files are running using CPU (amber.cpu.sub) while the equil and prod process are assigned to GPU (amber.cpu).</p>
<ul>
<li>Copy output elements (.nc files) to the local machine</li>
<li>Display .nc files with chimera, Tools/MD/Ensemble Analysis/MD Movie, it generates a movie of the system</li>
</ul>
<pre><code>scp user_name<span class="hljs-variable">@server_name</span><span class="hljs-symbol">:path_to_files/files</span> ./    <span class="hljs-comment"># copy from server to local</span>
scp ./files_to_copy user_name<span class="hljs-variable">@server_name</span><span class="hljs-symbol">:path_to/</span>  <span class="hljs-comment"># copy from local to server</span>
</code></pre><ul>
<li>Run minimization process with amber (min, heat, and density input files)</li>
<li>Define and run the production process (equil and prod input files), then adapat parameter to get the best performance in GPU  </li>
<li>Autoimage process: The periodical boundary conditions are added for the molecules inside the box</li>
</ul>
<pre><code>source /usr/local/amber20/amber<span class="hljs-selector-class">.sh</span>
cpptraj path_to/<span class="hljs-selector-class">.prmtop</span> &lt;&lt; eof
trajin prod<span class="hljs-selector-class">.nc</span> 
autoimage
trajout prod_img<span class="hljs-selector-class">.nc</span>
eof
</code></pre><ul>
<li>Remove system translation with cpptraj (pytraj for python)</li>
</ul>
<pre><code><span class="hljs-comment"># source /usr/local/amber20/amber.sh # ran previously</span>
cpptraj .path/.prmtop &lt;&lt; <span class="hljs-literal">eof</span>
trajin prod_img.nc 
rms <span class="hljs-keyword">first</span> out rms.dat @CA,C,N
trajout prod_img_rms.nc
<span class="hljs-literal">eof</span>
</code></pre><p>It generates one file where all the frames matcht the first one, prod-rms.out file.</p>
<ul>
<li>Calculate potential energies of the system, for ligand, protein, environment, and interaction between them and residues</li>
</ul>
<pre><code>/Users/asn/workspace/AmberEnergy++<span class="hljs-number">2</span>/bin/AmberEnergy++ path_to/.prmtop prod.nc |tee out_name.dat
<span class="hljs-number">3</span>        # <span class="hljs-keyword">select</span> NETCDF FORMAT <span class="hljs-keyword">FILE</span>
<span class="hljs-number">1</span>/<span class="hljs-number">2</span>/<span class="hljs-number">3</span>/<span class="hljs-number">4</span>  # <span class="hljs-keyword">select</span> energy calculations <span class="hljs-keyword">and</span> enter the number <span class="hljs-keyword">of</span> ligand <span class="hljs-keyword">and</span> residue <span class="hljs-keyword">of</span> interest
xmgrace -nxy <span class="hljs-keyword">out</span>.dat  # visualize potential energies <span class="hljs-keyword">with</span> xmgrace <span class="hljs-keyword">for</span> the ligand <span class="hljs-keyword">and</span> protein: Coulomb, VDW, <span class="hljs-keyword">and</span> total
</code></pre><ul>
<li>Use <a href="https://www.cgl.ucsf.edu/chimera/">Chimera</a> or <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a> to visualize the system trajectory, .prmtop, and .nc files are necessary</li>
</ul>
<p>The molecular dynamics simulations can be divided into the following steps:</p>
<ol>
<li><strong>Minimization</strong>: Heat, density, and min process</li>
<li><strong>Equilibrate</strong>: Equilibrate and production process</li>
<li><strong>LiGaMD</strong>: Prepare conventional MD and Gaussian Accelerated MD steps, <a href="http://miaolab.org/GaMD/manual.html">Manual of GaMD in Amber</a></li>
</ol>
<p>Since the systems (MR-COL and MR-AS4) are already defined and compiled, tleap and MD process, the following step is to make mutations to MR</p>
<p>Some useful file extension meanings:</p>
<ul>
<li><strong>prmtop</strong>: parameters and topology</li>
<li><strong>crd</strong>: coordinates</li>
<li><strong>pdb</strong>: protein database</li>
<li><strong>nc</strong>: trajectory ouput file, short of NetCDF (network Common Data Form) it stores multidimensional scientific data (variables)</li>
<li><strong>mol2</strong>: molecule model file, it contains the coordinates and charges. It is obtained using AC (quantum calculations) and PDBs, or exporting it from the prmtop and nc files using chimera</li>
</ul>
<p>The 3rd step:</p>
<ul>
<li><a href="http://miaolab.org/GaMD/tutorial.html">LiGaMD - tutorial</a></li>
<li><a href="http://miaolab.org/GaMD/manual.html">GaMD - manual</a> used to define steps and parameters to MD simulation</li>
<li><a href="http://miaolab.org/GaMD/lib/GaMD_Amber-Tutorial.pdf">GaMD_Amber-Tutorial</a> to define and tune LiGaMD parameters (sigma0/V)</li>
</ul>
<p>Prepare LiGaMD</p>
<ul>
<li>Input files examples in <a href="http://miaolab.org/GaMD/lib/GaMD_Amber-Tutorial.pdf">Amber tutorials</a> on page 5</li>
<li>Script to plot output files with python <a href="http://miaolab.org/PyReweighting/">PyReweighting</a></li>
<li><a href="http://miaolab.org/resources.html">Mioa Lab - resources</a></li>
<li>Check the meanning of LiGAMD input parameters <a href="http://ambermd.org/doc12/Amber22.pdf">amber manual</a> page 499, 471</li>
</ul>
<ul>
<li>Use <strong>making-it-rain</strong>, Amber_inputs.ipynb, with the complex outputs generated in the server (input for the notebook) files: .prmtop, .inpcrd, and .pdb</li>
</ul>
<h2 id="week-3">Week 3</h2>
<p>Create mutations systems and prepare again all necessary input files</p>
<ul>
<li>Reset numbering on MR mutation, it starts at 727</li>
<li>Add mutations to the ligand (S810L) in Chimera</li>
</ul>
<pre><code><span class="hljs-selector-tag">swapaa</span> <span class="hljs-selector-tag">leu</span><span class="hljs-selector-pseudo">:810</span>
</code></pre><ul>
<li>Prepare and run LiGaMD simulations on the server</li>
</ul>
<pre><code>iEP = <span class="hljs-number">2</span>
igamd = <span class="hljs-number">10</span> (single boost)
dt = <span class="hljs-number">0.001</span>
sigma0P = <span class="hljs-section">default</span> 
change mask    <span class="hljs-number">225</span> -&gt; <span class="hljs-number">1</span> (residue number)
</code></pre><ul>
<li>Calculation of energies in different residues</li>
</ul>
<center>

| <strong>Residue</strong> | <strong>Atom #</strong> | <strong>AS4</strong> | <strong>COL</strong> |
|:-----------:|:----------:|:-------:|:-------:|
|     SER     |     85     |     ~   |         |
|     ARG     |     92     |   <em>230  |    </em>    |
|     GLN     |     51     |         |    *    |
|     ASN     |     45     |         |         |
|     THR     |     222    |         |         |
|      HH     |     22     |         |         |
|     SER     |     118    |         |         |
|     SER     |     810    |         |         |

</center>

<p>where:</p>
<ul>
<li>*: relevant interaction with the frame number</li>
<li>~: middle interaction</li>
</ul>
<ul>
<li>Prepare and run the leaprc file for the MR mutations</li>
<li><p>Run equilibration process for the mutation systems    </p>
</li>
<li><p>Add histograms to energies plots</p>
</li>
<li>Run minimization step: min, heat, and density process for MR-AS4/COL_mut</li>
<li>Run production step: equil and prod process for the MR-AS4/COL_mut</li>
</ul>
<p>Prepare and test the <strong>LiBEla</strong> files</p>
<ul>
<li>Use the previous .nc and .prmtop files to generated the .mol2 file with the coordinates and charges of MR, AS4, and COL</li>
<li>Prepare the PDB file for the box</li>
<li>Prepare the input (libela.inp) file by changing some parameters</li>
<li>Create and submit the files for the MC simulations, parallel jobs are not required yet</li>
</ul>
<pre><code>source /share/apps/iMcLiBELa/LiBELa<span class="hljs-selector-class">.sh</span>
<span class="hljs-selector-tag">time</span> /share/apps/iMcLiBELa/bin/McLiBELa<span class="hljs-selector-class">.openmp</span> -<span class="hljs-selector-tag">i</span> libela.inp
</code></pre><p>the <strong>mode</strong> parameter can be</p>
<ul>
<li>eq (MC)</li>
<li>docking</li>
<li><p>MCR</p>
</li>
<li><p>Prepare several input files for the Mc simulations and change the random seed. 10 samples are ok</p>
</li>
</ul>
<h1 id="-md-scpi-project-https-saguileran-github-io-md-scpi-"><a href="https://saguileran.github.io/MD-SCPI/">MD-SCPI project</a></h1>
<p>Home page of the project, short description</p>

